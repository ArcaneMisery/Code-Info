# Замыкание  
### Замыкание функция которая запоминает свои внешние переменные и может получить к ним доступ.  
В некоторых языуках это невоможно либо функция должна быть написана специальным образом. **Но в js все функции являются замыканиями** кроме синтаксиса new Function.  
## Техническая часть замыкания  
Все глобальное тело кода есть свойства большого обьекта Enviroment record. То есть все переменные и тд записываются как его ключи и свойства. Записываются они туда в момента прочитывания их в коде.  
Когда вызываются и обьявляются функции они инициализируются раньше переменных, когда создается лексическое окружение.  
Когда создается любая функция в ней появляется свое скрытое свойство [Enviroment]- внутреннее лууксическое окружение.  
Когда функция срабатывает, происходит считывание трёх этапов:  
Внутреннее окржуение => внешнее окружение(если есть вложенная функция) => глобальное окружение  
**Таким образом функция всегда получает значение текущего(последнего) состояния переменной**  
## Доп инфа  
К любой части кода в ``{}`` приписывается скрытое совйство [Enviroment]. Область видимости таких блоков кода является той же что у функций.  
К при меру блок ``for (let...) {smth}`` или ``if(){smth}`` имеет такое же поведение как функция.  
### Сборка мусора  
Все работает стандартно, функция выполнилась и удалилась из памяти, но если у функции есть вложенная функция ссылающаяся на область памяти внешней, она останется достижимой и не удалится из памяти.  
```javascript
function f() {
  let value = 123;
  function g() { alert(value); }
  return g;
}
let g = f(); // g доступно и продолжает держать внешнее лексическое окружение в памяти
```
